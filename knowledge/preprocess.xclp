/* preprocessing rules for vectorization */

include "vrg-sugar.xclp"

module Vectorize.

#?A, #?B, meet(?A, ?B, ?l) => ?A [~//] ?B, ?l [on] ?A, ?l [on] ?B.

\?a, \?b, meet(?a, ?b, ?)
=>
    ?A := gensym(), #?A,
    ?a [on] ?A, ?b [on] ?A,
    ?a [~//] ?b.

\?a, #?A, meet(?a, ?A, ?) => ?a [~//] ?A, ?a [~on] ?A.

\?a, #?alpha, \?b, project(?a, ?alpha, ?b)
=>
    ?theta := gensym(), #?theta,
    ?a [X] ?alpha, ?a [on] ?theta,
    meet(?theta, ?alpha, ?b),
    ?theta [T] ?alpha.
