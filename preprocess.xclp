/* preprocessing rules for vectorization */

include "vrg-sugar.xclp".

module Vectorize.

#?a, \?b, ?a [?R] ?b => ?b [?R] ?a.

#?A, #?B, meet(?A, ?B, ?l) => ?A [~//] ?B, ?l [on] ?A, ?l [on] ?B.

\?a, \?b, meet(?a, ?b, ?) => ?a [~//] ?b.

\?a, #?A, meet(?a, ?A, ?) => ?a [~//] ?A, ?a [~on] ?A.

\?a, #?alpha, \?b, project(?a, ?alpha, ?b)
=> bind(?theta, gensym()),
   ?a [X] ?alpha, ?a [on] ?theta,
   meet(?theta, ?alpha, ?b),
   ?theta [T] ?alpha.
